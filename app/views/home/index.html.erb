<h1 class="text-3xl font-bold text-blue-600 mb-4">My Facebook Clone</h1>

<% if current_user %>
  <div class="mb-4">
    <%= link_to "New Post", new_post_path, class: "bg-blue-500 text-white px-4 py-2 rounded" %>
    <%= link_to "Log Out", destroy_user_session_path, method: :delete, class: "ml-2 bg-gray-500 text-white px-4 py-2 rounded" %>
  </div>

  <h2 class="text-2xl font-bold mt-6 mb-2">Feed</h2>

  <% Post.all.order(created_at: :desc).each do |post| %>
    <% user_like = post.likes.find_by(user: current_user) %>

    <div class="border rounded p-4 mb-4 bg-white shadow">
      <p class="font-semibold"><%= post.user.email %></p>
      <p class="mt-2"><%= post.body %></p>
      <p class="text-gray-500 text-sm mt-2"><%= post.created_at.strftime("%b %d, %Y %H:%M") %></p>

      <p class="mt-2">
        <%= pluralize(post.likes.count, "Like") %>
        <% if user_like %>
          <%= button_to "Unlike", post_like_path(post_id: post.id, id: user_like.id), method: :delete, class: "ml-2 bg-red-500 text-white px-2 py-1 rounded" %>
        <% else %>
          <%= button_to "Like", post_likes_path(post_id: post.id), method: :post, class: "ml-2 bg-blue-500 text-white px-2 py-1 rounded" %>
        <% end %>
      </p>
    </div>
  <% end %>

<% else %>
  <%= link_to "Sign Up", new_user_registration_path, class: "bg-green-500 text-white px-4 py-2 rounded" %>
  <%= link_to "Log In", new_user_session_path, class: "ml-2 bg-gray-500 text-white px-4 py-2 rounded" %>
<% end %>
